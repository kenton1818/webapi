{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Price Aggregator -- Save Your Money</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="{% static 'css/open-iconic-bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

    <link rel="stylesheet" href="{% static 'css/aos.css' %}">

    <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery.timepicker.css' %}">

    
    <link rel="stylesheet" href="{% static 'css/flaticon.css' %}">
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block cover_page_css%} {% endblock %}
  </head>
  <body>




<div id="login" class="modal">
  <form class="loginmodal-content animate" action="/action_page.php">
    
      <div class="imgcontainer"     text-align ="center" margin = "24px 0 12px 0" position = "relative">
      <span onclick="document.getElementById('login').style.display='none'" class="close" title="Close PopUp">&times;</span>
      <img src="{% static '/images/icon.jpg' %}" alt="Avatar" class="avatar"  >
      <h1 style="text-align:center;font-size: 23px;" >Welcome Price Aggregator</h1>
    </div><center>
    <div class="form-group">
     
                                          <label for="exampleInputUsername">Email</label>
                                          <input style="width: 80%;" type="email" class="form-control" id="exampleInputUsername" aria-describedby="emailHelp" placeholder="Email">
                                          <small id="emailHelp" class="form-text text-muted">Enter your registred E-mail ID</small>
                                        </div>
                            <div class="form-group">

                                          <label for="exampleInputPassword">Password</label>
                                          <input style="width: 80%;"  type="password" name="password" class="form-control" id="exampleInputPassword" placeholder="Password" />
                                          <div id="errorlogin" style="color:red"></div>
                                        </div>
                                         <button type="button" class="btn btn-primary btn-lg btn-block login-btn" style="max-width:500px" onclick="userlogin()">Login</button>
              </center>                           
  </form>
</div>



<div id="registor" class="modal">
  <form class="registormodal-content animate" action="/action_page.php">
    
      <div class="imgcontainer"     text-align ="center" margin = "24px 0 12px 0" position = "relative">
      <span onclick="document.getElementById('login').style.display='none'" class="close" title="Close PopUp">&times;</span>
      <img src="{% static '/images/icon.jpg' %}" alt="Avatar" class="avatar"  >
      <h1 style="text-align:center;font-size: 23px;" >Welcome Price Aggregator</h1>
    </div>
    <center>
<div class="form-group">
        <div id="errorname" style="color:red">
                                        </div>
                                          <label  for="InputFname">First Name</label>
                                          <input style="width: 50%;" type="text" class="form-control" id="InputFname" aria-describedby="emailHelp" placeholder="First Name">
                                        </div>

                                        <div class="form-group">
                                          <label for="InputLname">Last Name</label>
                                          <input style="width: 50%;" type="text" class="form-control" id="InputLname" aria-describedby="emailHelp" placeholder="Last Name">
                                        </div>
                                        
                                        <div class="form-group">
                                        <div id="erroremail" style="color:red">
                                        </div>
                                          <label for="InputEmail">Email address</label>
                                          <input style="width: 80%;" type="email" class="form-control" id="InputEmail" aria-describedby="emailHelp" placeholder="Enter email">
                                        </div>
                                        
                                        <div class="form-group">
                                        <div id="errorpass" style="color:red">
                                        </div>
                                          <label for="Password1">Create Password</label>
                                          <input style="width: 80%;" type="password" class="form-control" id="Password1" placeholder="Password" />
                                        </div>
                                        <div class="form-group">
                                          <label for="InputPassword2">Confirm Password</label>
                                          <input style="width: 80%;" type="password" class="form-control" id="InputPassword2" placeholder="Password" />
                                        </div>
                                        </center>
                    <button type="button"  class="btn btn-primary btn-lg btn-block login-btn mb-2 mt-2" onclick="signup()" style="width:100%">Sign up</button>
                                        {% csrf_token %}
  </form>
</div>



    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
      <div class="container">
        <a class="navbar-brand" href="{% url 'cover_page'  %}">Price   <span>  Aggregator</span></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation" id = 'menu'>
          <span class="oi oi-menu"></span> Menu
        </button>

        <div class="collapse navbar-collapse" id="ftco-nav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active"><a href="index.html" class="nav-link">Home</a></li>
            <li class="nav-item"><a href="property.html" class="nav-link">Property</a></li>
            <li class="nav-item"><a href="agents.html" class="nav-link">Agents</a></li>
            
            {% if user.is_authenticated %}
              <script type="text/javascript">alert('okok')</script>
                {{ user}}
              {% else %}
              <!--  login in -->
            <li class="nav-item cta"><button id = "click_login" onclick="btnLoginAction()" class="nav-link ml-lg-2"><span class="icon-user"></span  > Sign-In</button></li>
            <li class="nav-item cta cta-colored"><button onclick="btnRegistorAction()"   class="nav-link"><span class="icon-pencil"></span> <S>  </S>Sign-Up</button></li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
    <!-- END nav -->







     {% block body%} {% endblock %}
  

<style >


/* Center the image and position the close button */
.imgcontainer {
    text-align: center;
    margin: 24px 0 12px 0;
    position: relative;
}
.avatar {
    width: 30%;
  height: 30%;
    border-radius: 50%;
}

/* The Modal (background) */
.modal {
  display:none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
}

/* Modal Content Box */
.loginmodal-content {
    background-color: #fefefe;
    margin: 10% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

} /* Modal Content Box */
.registormodal-content {
    background-color: #fefefe;
    margin: 7% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

} 


/* The Close Button (x) */
.close {
    position: absolute;
    right: 25px;
    top: 0;
    color: #000;
    font-size: 35px;
    font-weight: bold;
}
.close:hover,.close:focus {
    color: red;
    cursor: pointer;
}

/* Add Zoom Animation */
.animate {
    animation: zoom 0.6s
}
@keyframes zoom {
    from {transform: scale(0)} 
    to {transform: scale(1)}
}
</style>

<!-- 當用戶點下login時自動宿回negbar -->

<script >
        function btnLoginAction()
        {document.getElementById('login').style.display='block' ;
        $("#ftco-nav").collapse('hide');
      }
      function btnRegistorAction()
        {document.getElementById('registor').style.display='block' ;
        $("#ftco-nav").collapse('hide');
      }
      

      function signup(){
            email = document.getElementById("InputEmail").value;
            fname = document.getElementById("InputFname").value;
            lname = document.getElementById("InputLname").value;
            password1 = document.getElementById("Password1").value;
            password2 = document.getElementById("InputPassword2").value;
            csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
            $("#erroremail").html("");
            $("#errorpass").html("");
                        if(fname == "" || lname == ""){
                $("#errorname").html("First Name and Last Name Required");
            }

      }



</script>


<script type="text/javascript">
  
    function userlogin(){
        email = document.getElementById("exampleInputUsername").value;
        password = document.getElementById("exampleInputPassword").value;
        csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
        $("#errorlogin").html("");
        $.ajax({
            type:"POST",
            url:'/login/',
            data:{
                'csrfmiddlewaretoken': csrfmiddlewaretoken,
                'email':email,
                'password':password,
            },
            success : function(data){
                console.log(data);
                if(data['message'] == "Success"){
                    location.reload();
                }
                else if(data['message'] == "inactive"){
                    $("#errorlogin").html("Please verify this E-mail address.");
                }
                else{
                    $("#errorlogin").html("The E-mail and Password do not match.");
                }
            }
        });
    }

</script>



<script type="text/javascript">
          function signup(){
            alert('registor')
            email = document.getElementById("InputEmail").value;
            fname = document.getElementById("InputFname").value;
            lname = document.getElementById("InputLname").value;
            password1 = document.getElementById("Password1").value;
            password2 = document.getElementById("InputPassword2").value;
            csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
            $("#erroremail").html("");
            $("#errorpass").html("");
            if(fname == "" || lname == ""){
                $("#errorname").html("First Name and Last Name Required");
            }
            else{
            $.ajax({
            type:"POST",
            url:'/signup/',
            data:{
                'csrfmiddlewaretoken': csrfmiddlewaretoken,
              'first_name':fname,
              'last_name':lname,
              'email':email,
              'password1':password1,
              'password2':password2,
            },
            success : function(data){
                console.log('11111111')
                console.log(data);
                if(data['message'] == "Success"){
                    window.location = "/"
                
                }
                
                else{
                    if("email" in data['message'])
                        $("#erroremail").html(data['message']['email'][0]);
                    if("password2" in data['message'])
                        $("#errorpass").html(data['message']['password2'][0]);
                }
            }
        })
        }
      }

</script>



<script>
var login = document.getElementById('login');
var registor = document.getElementById('registor');
window.onclick = function(event) {
    if (event.target == login) {
        login.style.display = "none";
    }
      if (event.target == registor) {
        registor.style.display = "none";
    }
}
</script>
<style >
   

</style>


  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/jquery-migrate-3.0.1.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
  <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
  <script src="{% static 'js/jquery.stellar.min.js' %}"></script>
  <script src="{% static 'js/owl.carousel.min.js' %}"></script>
  <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'js/aos.js' %}"></script>
  <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
  <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
  <script src="{% static 'js/jquery.timepicker.min.js' %}"></script>
  <script src="{% static 'js/scrollax.min.js' %}"></script>
  <script src="{% static 'js/main.js' %}"></script>
    
  </body>
</html>