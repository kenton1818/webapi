{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">

<head>
  {% csrf_token %}
  <title>Price Aggregator -- Save Your Money</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="{% static 'css/open-iconic-bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/animate.css' %}">

  <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

  <link rel="stylesheet" href="{% static 'css/aos.css' %}">

  <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}">

  <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">
  <link rel="stylesheet" href="{% static 'css/jquery.timepicker.css' %}">


  <link rel="stylesheet" href="{% static 'css/flaticon.css' %}">
  <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  {% block cover_page_css%} {% endblock %}
</head>

<body>





  <div id="login" class="modal">
    <form class="loginmodal-content animate" action="/action_page.php">

      <div class="imgcontainer" text-align="center" margin="24px 0 12px 0" position="relative">
        <span onclick="document.getElementById('login').style.display='none'" class="close" title="Close PopUp">&times;</span>
        <img src="{% static '/images/icon.jpg' %}" alt="Avatar" class="avatar">
        <h1 style="text-align:center;font-size: 23px;">Welcome Price Aggregator</h1>
      </div>
      <center>
        <div class="form-group">

          <label for="exampleInputUsername">Email</label>
          <input style="width: 80%;" type="email" class="form-control" id="exampleInputUsername" aria-describedby="emailHelp"
            placeholder="Email">
          <small id="emailHelp" class="form-text text-muted">Enter your registred E-mail ID</small>
        </div>
        <div class="form-group">

          <label for="exampleInputPassword">Password</label>
          <input style="width: 80%;" type="password" name="password" class="form-control" id="exampleInputPassword"
            placeholder="Password" />
          <div id="errorlogin" style="color:red"></div>
        </div>
        <button type="button" class="btn btn-primary btn-lg btn-block login-btn" style="max-width:500px" onclick="userlogin()">Login</button>

      </center>
    </form>
  </div>







  <div id="operate_success" class="modal">
    <div class='loginmodal-content animate' >
      <div class="imgcontainer" text-align="center" margin="24px 0 12px 0" position="relative">
        <span onclick="document.getElementById('login').style.display='none'" class="close" title="Close PopUp">&times;</span>
        <img src="{% static '/images/operation_success_icon__406113.png' %}" alt="Avatar" class="avatar">
        <h1 style="text-align:center;font-size: 23px;">Operation Success</h1>
      </div>
      <center>
        <button type="button" class="btn btn-primary btn-lg btn-block login-btn" style="max-width:500px" onclick="btnOkAction()">OK</button>
    </div>
    </center>
  </div>



    <div id="UserInfo" class="modal">
      <div id="vcard">
        <div id="card-content">
          <div id="profile">
            <span class="avatar">
              <span class="typicons-user icon"></span>
              <span class="info">
               John Doe
                <br />
               john.doe@freelancer.com
              </span>
            </span>
          </div>
          <div id="options">
            <ul>
              <li><span class="typicons-anchor icon"></span>WEBSITE</li>
              <li><span class="typicons-export icon"></span>SHARE</li>
              <li><span class="typicons-plus icon"></span>FOLLOW</li>
              <li><span class="typicons-tab icon"></span>HIRE</li>
            </ul>
          </div>
        </div>
        <div id="side-bar">
          <ul>
            <li><span class="typicons-user icon"></span>PROFILE</li>
            <li><span class="typicons-list icon"></span>PROJECTS</li>
            <li><span class="typicons-spanner icon"></span>SKILLS</li>
            
          </ul>
        </div>
      </div>
      </div>















  <div id="registor" class="modal">
    <form class="registormodal-content animate" action="/action_page.php">

      <div class="imgcontainer" text-align="center" margin="24px 0 12px 0" position="relative">
        <span onclick="document.getElementById('registor').style.display='none'" class="close" title="Close PopUp">&times;</span>
        <img src="{% static '/images/icon.jpg' %}" alt="Avatar" class="avatar">
        <h1 style="text-align:center;font-size: 23px;">Welcome Price Aggregator</h1>
      </div>
      <center>
        <div class="form-group">
          <div id="errorname" style="color:red">
          </div>
          <label for="InputFname">First Name</label>
          <input style="width: 50%;" type="text" class="form-control" id="InputFname" aria-describedby="emailHelp"
            placeholder="First Name">
        </div>

        <div class="form-group">
          <label for="InputLname">Last Name</label>
          <input style="width: 50%;" type="text" class="form-control" id="InputLname" aria-describedby="emailHelp"
            placeholder="Last Name">
        </div>

        <div class="form-group">
          <div id="erroremail" style="color:red">
          </div>
          <label for="InputEmail">Email address</label>
          <input style="width: 80%;" type="email" class="form-control" id="InputEmail" aria-describedby="emailHelp"
            placeholder="Enter email">
        </div>

        <div class="form-group">
          <div id="errorpass" style="color:red">
          </div>
          <label for="Password1">Create Password</label>
          <input style="width: 80%;" type="password" class="form-control" id="Password1" placeholder="Password" />
        </div>
        <div class="form-group">
          <label for="InputPassword2">Confirm Password</label>
          <input style="width: 80%;" type="password" class="form-control" id="InputPassword2" placeholder="Password" />
        </div>
      </center>
      <button type="button" class="btn btn-primary btn-lg btn-block login-btn mb-2 mt-2" onclick="signup()" style="width:100%">Sign
        up</button>

    </form>
  </div>



  <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
    <div class="container">
      <a class="navbar-brand" href="{% url 'cover_page'  %}">Price <span> Aggregator</span></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav"
        aria-expanded="false" aria-label="Toggle navigation" id='menu'>
        <span class="oi oi-menu"></span> Menu
      </button>

      <div class="collapse navbar-collapse" id="ftco-nav">
        <ul class="navbar-nav ml-auto" id='home_bar'>
          <li class="nav-item active"><a href="index.html" class="nav-link">Home</a></li>
          <li class="nav-item"><a href="property.html" class="nav-link">Property</a></li>
          <li class="nav-item"><a href="agents.html" class="nav-link">Agents</a></li>

          {% if user.is_authenticated %}

          <li class="nav-item cta" id='id_loginedblock'><button id="user_status" onclick="btnInfo()" class="nav-link ml-lg-2"><span
                class="icon-user"></span> {{ user}}</button></li>
          <li class="nav-item cta cta-colored" id='user_logout'><button onclick="btnLogout()" class="nav-link"><span
                class="icon-pencil"></span> <S> </S>Logout</button></li>


          {% else %}
          <!--  login in -->

          <li class="nav-item cta" id='id_loginblock'><button id="click_login" onclick="btnLoginAction()" class="nav-link ml-lg-2"><span
                class="icon-user"></span> Sign-In</button></li>
          <li class="nav-item cta cta-colored" id='id_regisblock'><button onclick="btnRegistorAction()" class="nav-link"><span
                class="icon-pencil"></span> <S> </S>Sign-Up</button></li>

          {% endif %}
        </ul>
      </div>
    </div>
  </nav>
  <!-- END nav -->


  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px" display="block">
      <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
      <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg></div>





  {% block body%} {% endblock %}


  <style>
    /* Center the image and position the close button */
.imgcontainer {
    text-align: center;
    margin: 24px 0 12px 0;
    position: relative;
}
.avatar {
    width: 30%;
  height: 30%;
    border-radius: 50%;
}

/* The Modal (background) */
.modal {
  display:none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
}

/* Modal Content Box */
.loginmodal-content {
    background-color: #fefefe;
    margin: 10% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

}

/* Modal Content Box */
.sucessmodal-content {
    background-color: #fefefe;
    margin: 10% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

}
/* Modal Content Box */
.userInfo-content {
    background-color: #fefefe;
    margin: 10% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

}
/* Modal Content Box */
.registormodal-content {
    background-color: #fefefe;
    margin: 7% auto 15% auto;
    border: 1px solid #888;
    width: 40%; 
  padding-bottom: 30px;

} 


/* The Close Button (x) */
.close {
    position: absolute;
    right: 25px;
    top: 0;
    color: #000;
    font-size: 35px;
    font-weight: bold;
}
.close:hover,.close:focus {
    color: red;
    cursor: pointer;
}

/* Add Zoom Animation */
.animate {
    animation: zoom 0.6s
}
@keyframes zoom {
    from {transform: scale(0)} 
    to {transform: scale(1)}
}
</style>

  <!-- 當用戶點下login時自動宿回negbar -->
  <script>
    function btnLoginAction() {
      document.getElementById('login').style.display = 'block';
      $("#ftco-nav").collapse('hide');
    }

    function btnInfo() {
      document.getElementById('UserInfo').style.display = 'block';
      $("#ftco-nav").collapse('hide');
    }

    function btnRegistorAction() {
      document.getElementById('registor').style.display = 'block';
      $("#ftco-nav").collapse('hide');
    }

    function btnSuccessAction() {
      document.getElementById('operate_success').style.display = 'block';
      $("#ftco-nav").collapse('hide');
    }

    function btnOkAction() {
      var status = document.getElementById('operate_success');
      status.style.display = "none";

    }
  </script>
  <!--用戶登出-->
  <script>
    function btnLogout() {
      $.ajax({
        type: "POST",
        url: '/api/user/logout/',
        data: {
          'csrfmiddlewaretoken': csrfmiddlewaretoken,
        },

        success: function (data) {

          console.log(data);
          if (data['status'] == "logout success") {
            var status = document.getElementById('user_status')
            var logout = document.getElementById('user_logout')
            status.style.display = "none"
            logout.style.display = "none"

            user_login =
              '<li class="nav-item cta" id="id_loginblock"><button id="click_login" onclick="btnLoginAction()" class="nav-link ml-lg-2"><span                class="icon-user"></span> Sign-In</button></li>'
            user_signin =
              '<li class="nav-item cta cta-colored" id="id_regisblock"><button onclick="btnRegistorAction()" class="nav-link"><span  class="icon-pencil"></span> <S> </S>Sign-Up</button></li>'
            $("#home_bar").append(user_login)
            $("#home_bar").append(user_signin)
            btnSuccessAction()



          }

        }
      });
    }
  </script>

  <!--用戶登入-->
  <script type="text/javascript">
    function userlogin() {
      email = document.getElementById("exampleInputUsername").value;
      password = document.getElementById("exampleInputPassword").value;
      if (email == '') {
        $("#errorlogin").html("Please enter E-mail address.");
      } else if (password == '') {
        $("#errorlogin").html("Please enter Password.");
      } else {
        csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
        $("#errorlogin").html("");
        $.ajax({
          type: "POST",
          url: '/api/user/login/',
          data: {
            'csrfmiddlewaretoken': csrfmiddlewaretoken,
            'email': email,
            'password': password,
          },

          success: function (data) {

            console.log(data);
            if (data['status'] == "login success") {

              var registor = document.getElementById('id_regisblock')
              var login = document.getElementById('click_login')
              login.style.display = "none"
              registor.style.display = "none"
              var login_popup = document.getElementById('login');
              login_popup.style.display = "none"
              user_logined =
                ' <li class="nav-item cta"  id = "id_loginedblock"><button id = "user_status" onclick="" class="nav-link ml-lg-2"><span class="icon-user"></span  >' +
                email + '</button></li>'
              user_logout =
                "<li class='nav-item cta cta-colored' id='user_logout'><button onclick='btnLogout()' class='nav-link'><span                  class='icon-pencil'></span> <S> </S>Logout</button></li>"
              $("#home_bar").append(user_logined)
              $("#home_bar").append(user_logout)
              btnSuccessAction()



            } else if (data['message'] == "error email") {
              $("#errorlogin").html("Please enter E-mail address.");
            } else if (data['message'] == "error password") {
              $("#errorlogin").html("Please enter password.");
            } else {
              $("#errorlogin").html("The E-mail and Password do not match.");
            }
          }
        });
      }
    }
  </script>


  <!--用戶注冊-->
  <script type="text/javascript">
    function signup() {
      email = document.getElementById("InputEmail").value;
      fname = document.getElementById("InputFname").value;
      lname = document.getElementById("InputLname").value;
      password1 = document.getElementById("Password1").value;
      password2 = document.getElementById("InputPassword2").value;
      csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
      $("#erroremail").html("");
      $("#errorpass").html("");
      if (fname == "" || lname == "") {
        $("#errorname").html("First Name and Last Name Required");
      } else {

        $.ajax({
          type: "POST",
          url: '/api/user/register/',
          data: {
            'csrfmiddlewaretoken': csrfmiddlewaretoken,
            'first_name': fname,
            'last_name': lname,
            'email': email,
            'password1': password1,
            'password2': password2,
          },
          success: function (data) {
            if (data['status'] == "register success") {
              var registor = document.getElementById('registor');
              registor.style.display = "none";
              $.ajax({
                type: "POST",
                url: '/api/user/login/',
                data: {
                  'csrfmiddlewaretoken': csrfmiddlewaretoken,
                  'email': email,
                  'password': password1,
                },

                success: function (data) {

                  console.log(data);
                  if (data['status'] == "login success") {

                    var registor = document.getElementById('id_regisblock')
                    var login = document.getElementById('click_login')
                    login.style.display = "none"
                    registor.style.display = "none"
                    var login_popup = document.getElementById('login');
                    login_popup.style.display = "none"
                    user_logined =
                      ' <li class="nav-item cta"  id = "id_loginedblock"><button id = "user_status" onclick="" class="nav-link ml-lg-2"><span class="icon-user"></span  >' +
                      email + '</button></li>'
                    user_logout =
                      "<li class='nav-item cta cta-colored' id='user_logout'><button onclick='btnLogout()' class='nav-link'><span                  class='icon-pencil'></span> <S> </S>Logout</button></li>"
                    $("#home_bar").append(user_logined)
                    $("#home_bar").append(user_logout)
                    btnSuccessAction()



                  } else if (data['message'] == "error email") {
                    $("#errorlogin").html("Please enter E-mail address.");
                  } else if (data['message'] == "error password") {
                    $("#errorlogin").html("Please enter password.");
                  } else {
                    $("#errorlogin").html("The E-mail and Password do not match.");
                  }
                }
              });







            } else {
              if ("email" in data['message'])
                $("#erroremail").html(data['message']['email'][0]);
              if ("password2" in data['message'])
                $("#errorpass").html(data['message']['password2'][0]);
              if ("password1" in data['message'])
                $("#errorpass").html(data['message']['password1'][0]);
            }
          }
        })
      }
    }
  </script>


  <!--當用戶點視窗外就把popup screen close-->
  <script>
    var login = document.getElementById('login');

    var registor = document.getElementById('registor');
    var status = document.getElementById('operate_success');
    var UserInfo = document.getElementById('UserInfo');

    window.onclick = function (event) {
      if (event.target == login) {
        login.style.display = "none";
      }
      if (event.target == UserInfo) {
        UserInfo.style.display = "none";
      }
      if (event.target == registor) {
        registor.style.display = "none";
      }
      if (event.target == status) {
        status.style.display = "none";
      }
    }
  </script>
  <style>
    @import url(http://weloveiconfonts.com/api/?family=typicons);
@import url(https://fonts.googleapis.com/css?family=Exo:500,700);

/* typicons */
[class*="typicons-"]:before {
  font-family: 'Typicons', sans-serif;
}

#vcard {
  margin: 0 auto;
  width: 600px;
  height: 350px;
  background: #109fd1;
  border-radius: 4px;
  box-shadow: 0px 5px 15px rgba(0,0,0, .3);
  margin: 13% auto 15% auto
}
#card-content {
  width: 500px;
  float: left;
  height: 100%;
  
}
#side-bar {
  width: 100px;
  float: left;
  background: #fff;
  height: 100%;
  border-radius: 0 4px 4px 0;
  box-shadow: -5px 0px 15px rgba(0,0,0, .3);
}
#profile {
  height: 200px;
  border-bottom: solid 1px rgba(255,255,255,.2);
}
#options ul {
  margin: 0;
  padding: 0;
}
#options ul li{
  text-align: center;
  font-family: Exo;
  font-size: 14px;
  color: white;
  list-style-type: none;
  display: inline-block;
  float: left;
  width: 123px;
  height: 100px;
  border-right: solid 1px rgba(255,255,255,.2);
  text-shadow: 1px 1px 3px rgba(0,0,0,.3);
}
#options ul li:last-child{

  border-right: none;
}
#options ul li span.icon {
  display: block;
  margin-top: 25px;
  color: white;
  font-size: 24px;
  line-height: 32px;
}

#side-bar ul {
  margin: 0;
  padding: 0;
}
#side-bar ul li{
  
  text-align: center;
  font-family: Exo;
  font-size: 12px;
  color: #414141;
  list-style-type: none;
  display: inline-block;
  float: left;
  width: 100px;
  height: 115px;
  border-bottom: solid 1px #eaeaea;
  
}
#side-bar ul li:last-child{

  border-bottom: none;
}
#side-bar ul li span.icon {
  display: block;
  margin-top: 25px;
  color: #414141;
  font-size: 36px;
  line-height: 32px;
}

#profile {
  padding-top: 17px;
  text-align: center;
  overflow: auto;
}
span.avatar span.icon{
  display: inline-block;
  color: #414141;
  font-size: 72px;
  line-height: 100px;
  background: #46af7b;
  border: solid 3px rgba(255,255,255, .2);
  overflow: hidden;
  padding-top: 1px;
  width: 90px;
  height: 90px;
  border-radius: 46px;
}
span.info {
  padding-top: 10px;
  display: block;
  font-family: Exo;
  font-size: 18px;
  color: rgba(255,255,255, .7);
  font-weight: normal;
  text-shadow: 1px 1px 3px rgba(0,0,0,.3);
}
  </style>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="{% static 'js/jquery-migrate-3.0.1.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="https://stackpath.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"></script>
  <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
  <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
  <script src="{% static 'js/jquery.stellar.min.js' %}"></script>
  <script src="{% static 'js/owl.carousel.min.js' %}"></script>
  <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'js/aos.js' %}"></script>
  <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
  <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
  <script src="{% static 'js/jquery.timepicker.min.js' %}"></script>
  <script src="{% static 'js/scrollax.min.js' %}"></script>
  <script src="{% static 'js/main.js' %}"></script>
  {% block script%} {% endblock %}
</body>

</html>